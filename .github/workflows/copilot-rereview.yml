name: Trigger Copilot Re-review

# Trigger on every push to PR (BMAD/Claude pushes)
# This workflow ensures Copilot code review is triggered after each push
# The actual review is handled by the repository ruleset with copilot_code_review enabled
on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  trigger-review:
    name: Trigger Copilot Review
    runs-on: ubuntu-latest

    # Skip for draft PRs
    if: github.event.pull_request.draft == false

    permissions:
      pull-requests: write

    steps:
      - name: Log review trigger
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          PR_NUMBER=${{ github.event.pull_request.number }}

          echo "ðŸ¤– Push detected for PR #$PR_NUMBER"
          echo "Triggered by: ${{ github.event.action }} from ${{ github.actor }}"
          echo "Commit: ${{ github.event.pull_request.head.sha }}"

          # Copilot code review is automatically triggered by the repository ruleset
          # This workflow just logs the event for visibility
          echo "âœ… Copilot review will be triggered by ruleset for PR #$PR_NUMBER"
